---
layout: default
title: Import Data From Excel
category: sql
---

<h2>{{ page.title }}</h2>
<ul class="list-decimal">
	<li>Connect to the DB server with SSIS</li>
	<li>Export all data to an excel</li>
	<li>On local<br>
		{% highlight sql %}
			before import data
			EXEC sp_MSForEachTable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'
			EXEC sp_MSForEachTable 'ALTER TABLE ? DISABLE TRIGGER ALL'
			EXEC sp_MSForEachTable 'DELETE FROM ?'

			after import data
			EXEC sp_MSForEachTable 'ALTER TABLE ? CHECK CONSTRAINT ALL'
			EXEC sp_MSForEachTable 'ALTER TABLE ? ENABLE TRIGGER ALL'
			EXEC sp_MSFOREACHTABLE 'SELECT * FROM ?'
		{% endhighlight %}
	</li>
	<li>Import data from the excel
		<img width="450" height="461" src="{{ site.baseurl }}/images/import_data_ssis.jpg">
	</li>
</ul>
<p>{{ page.date | date_to_string }}</p>